jboss 같은 웹 앱 서버의 아키텍쳐를 구성하는 것은 Java EE
(JavaEE)는 servlet,jsp,ejb같은 애플리케이션들이 사용하는 컴포넌트 및 서비스의 표준을 정한 것.

특히 앱이 기존의 시스템과 서비스에 연결하기 위한 표준으로 "connector"가 정의되어 있음.
*javaSE는 우리가 일반적으로 사용하는 java 및 jvm버전.
*javaEE는 javaSE를 기반으로 서버에서 사용되는 API를 제공하는 것.

웹 인터페이스를 지원하는 JavaEE표준은 JSP,서블릿 -> 서버에서 실행되는 JAVA모듈(클래스)
서블릿은 웹 앱 서버에서 웹 인터페이스를 제공하는 것 이외에는 일반 클래스와 다를게 없어 JSP에 비해 복잡한 처리 가능.
즉, 사용자 입력에 응답 처리를 작성하는데 유용함.(Controller역할)

일반적으로 화면 출력은 view인 jsp에서 처리하고 사용자요청 처리를 서블릿에서 처리하는 개발구조를 가짐.

이제 이 view와 controller가 합쳐지면 시스템의 형태는 준비됨.
그러나 처리의 복잡성과 데이터 양이 늘어나면 곧 한계에 도달.
이유는 jsp,servlet모두 웹 앱 서버에서 동작하기 때문에 한 곳에서 모두 처리하는 형태.
그래서 해결하기 위해 데이터 처리의 중심이되는 model이 필요.
model 부분을 담당하는 표준이 EJB(Enterprise java Bean)임.
특징은 컴포넌트 지향과 분산 객체.
분산 객체는 다른 프로세스나 원격에서 실행중인 객체에 접근하는 기술을 뜻함.

이런 웹 서버의 아키텍쳐를 바탕으로. jboss eap를 구현
웹 서버의 기본적인 기능은 다음과 같음.'
1.애플리케이션 실행 환경
2.데이터베이스 커넥션 풀 기능
3.트랜잭션 관리
4.업무 처리의 흐름을 제어하는 비즈니스 로직 구현.

도메인모드.
여러 개의 jboss 인스턴스(여러개의 JVM)를 하나의 관리 단위로 묶어 관리하는 기능
1. 도메인 모드 설정파일 복사.
cp -R domain simpledomain

2. host설정 파일 디렉토리 이름인 simpledomain으로 변경 master -> simpledomain

3.도메인 시작 
./domain.sh -Djboss.domain.base.dir=/home/vagrant/jboss-eap-6.4/simpleDomain

도메인 컨트롤러.
도메인 모드에서 도메인 컨트롤러는 호스트 컨트롤러 중 하나가 그 역할을 담당하게 된다.
즉, 도메인 컨트롤러는 실제로는 호스트 컨트롤러 프로세스이지만
논리적으로 도메인 전체를 관리하는 것으로 지정된 것이다.
도메인에서 도메인 컨트롤러와 호스트 컨트롤러의 구성 상의 특징은 다음과 같다.

도메인 모드에서 도메인 컨트롤러는 하나만 존재
호스트 컨트롤러 중 하나에 도메인 컨트롤러 역할이 할당됨.
도메인 컨트롤러를 다른 도메인에 대한 도메인 컨트롤러로 설정하는 것은 불가.
하나의 도메인 컨트롤러에 관리 가능한 호스트 컨트롤러 수는 제한없음.

도메인 컨트롤러로 지정하는 방법은 도메인 컨트롤러가 될 host.xml파일에 <domain controller>을 설정

host.xml -> 도메인 컨트롤러 지정.
<domain-controller>
	<local/>
</domain-controller>

host.xml -> 관리할 인스턴스 컨트롤러 지정.
<domain-controller>
	<remote host= "ip" port=0000"/>
<domain-controller>


여러 대의 머신에서 도메인 구성하기
두 대의 머신에서 하나는 도메인 컨트롤러를 실행하여 master 노드 역할을 하고 다른 한 대는 slave 노드 역할을 한다.
서버 그룹은 'simpleServerGroup1'이라는 이름으로 설정하고, 서버 그룹 내의 master 호스트에는 'master_server1'과 
slave1 호스트에서 'slave1_server1'을 생성한다.

JBoss 관리자 계정 생성(도메인 전체를 관리할 관리자 생성)

도메인 컨트롤러로 지정할 master노드의 host.xml파일에서
host name = "master"로 변경
이후 


host.xml -> 도메인 컨트롤러 지정.
<domain-controller>
	<local/>
</domain-controller>


-=------------------------
slave 노드로와서 host.xml수정
host name = "slave1"
이후 host.xml파일에서 <security-realm name= "ManagementRealm"항목에 <server-identities>를 추가
<security-realm name="ManagementRealm">
        <server-identities>
          <secret value="b3Blbm5hcnUhMjM0"/>
        </server-identities>
여기서 secret value는 관리자 아이디 생성시 생성되는 시크릿값
이 시크릿으로 슬레이브노드의 호스트컨트롤러는 도메인컨트롤러에 접근가능.

이후 host.xml파일에서 username="관리자id"추가
<domain-controller>
  <remote host="$\{jboss.domain.master.address}" port="$\{jboss.domain.master.port:9999}" security-realm="ManagementRealm" username="admin"/>
</domain-controller>

이후 웹 관리 콘솔에서 서버 그룹 생성.




0. host도메인 관리자 생성(키벨류복사해놓기)

1.도메인 host.xml 수정 host이름
<domain-controller>
	<local/>
</domain-controller>

2.host 도메인 시작


3.slave host.xml 수정 slave이름,

<domain-controller>
  <remote host="$\{jboss.domain.master.address}" port="$\{jboss.domain.master.port:9999}" security-realm="ManagementRealm" username="admin"/>
</domain-controller>

4.slave host.xml 수정 (host도메인 관리자 생성시 나온 키 벨류 값 입력)

<security-realm name="ManagementRealm">
        <server-identities>
          <secret value="b3Blbm5hcnUhMjM0"/>
        </server-identities>

5.slave 시작시 host ip지정해두기

./domain.sh -Djboss.domain.master.address=192.168.56.111
